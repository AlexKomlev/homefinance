DROP TABLE TRANSACTIONS;
DROP TABLE TRANSACTION_TYPES;
DROP TABLE ACCOUNTS;

CREATE TABLE ACCOUNTS(
	ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	NAME VARCHAR(64) NOT NULL,
	TYPE INTEGER NOT NULL,
	CREDIT_RATE INTEGER,
	LIMIT INTEGER,
  DESCRIPTION VARCHAR(64) NOT NULL,
	UNIQUE(NAME)
	);

CREATE TABLE TRANSACTION_TYPES(
	ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	NAME VARCHAR(64) NOT NULL,
	DIRECTION INTEGER NOT NULL,
	DESCRIPTION VARCHAR(64) NOT NULL,
	UNIQUE(NAME)
);

CREATE TABLE TRANSACTIONS(
	ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
	SOURCE_ACCOUNT INTEGER NOT NULL,
	DESTINATION_ACCOUNT INTEGER NOT NULL,
	TYPE INTEGER NOT NULL,
	TRANSACTION_DATE DATE NOT NULL,
	VALUE INTEGER NOT NULL,
	DESCRIPTION VARCHAR(255),
	FOREIGN KEY (TYPE) REFERENCES TRANSACTION_TYPES (ID),
	FOREIGN KEY (SOURCE_ACCOUNT) REFERENCES ACCOUNTS (ID),
	FOREIGN KEY (DESTINATION_ACCOUNT) REFERENCES ACCOUNTS (ID)
);

INSERT INTO ACCOUNTS VALUES(1, 'cash', 0, null, null, 'Наличные');
INSERT INTO ACCOUNTS VALUES(2, 'citi_debit', 1, null, null, 'Дебетовая карта Сити');
INSERT INTO ACCOUNTS VALUES(3, 'citi_credit', 2, 18, 300000, 'Кредитная карта Сити');
INSERT INTO ACCOUNTS VALUES(4, 'street', 3, null, null, 'Счет типа street');

INSERT INTO TRANSACTION_TYPES VALUES(1, 'transfer', 3, 'Перевод');
INSERT INTO TRANSACTION_TYPES VALUES(2, 'incoming', 0, 'Зачисление');
INSERT INTO TRANSACTION_TYPES VALUES(3, 'balance', 2, 'Баланс');

INSERT INTO TRANSACTION_TYPES VALUES(4, 'rent', 1,'Квартплата');
INSERT INTO TRANSACTION_TYPES VALUES(5, 'food', 1,'Питание');
INSERT INTO TRANSACTION_TYPES VALUES(6, 'transport', 1, 'Транспорт');
INSERT INTO TRANSACTION_TYPES VALUES(7, 'mobile', 1, 'Мобильная связь');
INSERT INTO TRANSACTION_TYPES VALUES(8, 'internet', 1, 'Интернет');
INSERT INTO TRANSACTION_TYPES VALUES(9, 'childcare', 1, 'Детские товары');
INSERT INTO TRANSACTION_TYPES VALUES(10, 'cosmetics', 1, 'Косметика');
INSERT INTO TRANSACTION_TYPES VALUES(11, 'drugstore', 1, 'Аптека');
INSERT INTO TRANSACTION_TYPES VALUES(12, 'home', 1, 'Бытовые товары');
INSERT INTO TRANSACTION_TYPES VALUES(13, 'haircut', 1, 'Стрижка');
INSERT INTO TRANSACTION_TYPES VALUES(14, 'lenses', 1, 'Линзы');
INSERT INTO TRANSACTION_TYPES VALUES(15, 'lunch', 1, 'Питание на работе');
INSERT INTO TRANSACTION_TYPES VALUES(16, 'dainty', 1, 'Лакомства');
INSERT INTO TRANSACTION_TYPES VALUES(17, 'credit', 1, 'Кредит');
INSERT INTO TRANSACTION_TYPES VALUES(18, 'other', 2, 'Прочее');